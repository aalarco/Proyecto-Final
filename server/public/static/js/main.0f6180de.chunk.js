(this["webpackJsonpclient-proyecto-final"]=this["webpackJsonpclient-proyecto-final"]||[]).push([[0],{104:function(e,t,a){},105:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(26),o=a.n(s),i=a(6),l=a(9),c=a(11),u=a(10),m=a(12),h=a(30),d=(a(79),a(33)),p=a.n(d),v=function e(){var t=this;Object(i.a)(this,e),this.signup=function(e,a){return t._service.post("/signup",{username:e,password:a})},this.login=function(e,a){return t._service.post("/login",{username:e,password:a})},this.logout=function(){return t._service.post("/logout")},this.loggedin=function(){return t._service.get("/loggedin")},this._service=p.a.create({baseURL:"http://localhost:5000/api/auth",withCredentials:!0})},g=a(114),E=a(113),f=a(15),b=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logoutUser=function(){a._service.logout().then((function(e){return a.props.setUser(!1)})).catch((function(e){return console.log(e)}))},a._service=new v,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.loggedInUser?this.props.loggedInUser.username:"invitado";return this.props.loggedInUser?r.a.createElement(g.a,{className:"fixed-top",bg:"dark",variant:"dark",expand:"md"},r.a.createElement(g.a.Brand,null,"Moviestorm"),r.a.createElement(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(g.a.Collapse,null,r.a.createElement(E.a,{className:"mr-auto"},r.a.createElement(E.a.Link,{as:"li"},r.a.createElement(f.b,{to:"/"},"Inicio")),r.a.createElement(E.a.Link,{as:"li"},r.a.createElement(f.b,{to:"/lists"},"Listas")),r.a.createElement(E.a.Link,{as:"li"},r.a.createElement(f.b,{to:"/profile"},"Perfil"))),r.a.createElement(E.a,{className:"ml-auto"},r.a.createElement(g.a.Text,null,"Bienvenid@ ",e),r.a.createElement(E.a.Link,{as:"li",onClick:this.logoutUser},"Logout")))):r.a.createElement(g.a,{className:"fixed-top",bg:"dark",variant:"dark",expand:"md"},r.a.createElement(g.a.Brand,null,r.a.createElement("img",{src:"../../public/images/Logo-blanco.png",alt:"Logo"})),r.a.createElement(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(g.a.Collapse,null,r.a.createElement(E.a,{className:"mr-auto"},r.a.createElement(E.a.Link,{as:"li"},r.a.createElement(f.b,{to:"/"},"Inicio")),r.a.createElement(E.a.Link,{as:"li"},r.a.createElement(f.b,{to:"/movies"},"Listas"))),r.a.createElement(E.a,{className:"ml-auto"},r.a.createElement(E.a.Link,{as:"li"},r.a.createElement(f.b,{to:"/signup"},"Registro")),r.a.createElement(E.a.Link,{as:"li"},r.a.createElement(f.b,{to:"/login"},"Login")))))}}]),t}(n.Component),O=a(108),w=function e(){var t=this;Object(i.a)(this,e),this.getAllMovies=function(){return t._service.get("/getAllMovies")},this.getOneMovie=function(e){return t._service.get("/".concat(e))},this._service=p.a.create({baseURL:"http://localhost:5000/api/movies",withCredentials:!0})},j=a(107),C=a(68),S=a(33),_=function e(){var t=this;Object(i.a)(this,e),this.getMovieByID=function(e){return t._service.get("/movie/".concat(e,"?api_key=4a61e4d31818d43ef0d9ce519905732b"))},this.getMovieCast=function(e){return t._service.get("/credits/".concat(e,"?api_key=4a61e4d31818d43ef0d9ce519905732b"))},this._service=S.create({baseURL:"https://api.themoviedb.org/3"})},L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){a.apiInfo()},a.apiInfo=function(){a._apiService.getMovieByID(a.state.TMDB).then((function(e){a.setState({poster:e.data.poster_path})})).catch((function(e){return console.log(e)}))},a._apiService=new _,a.state={id:a.props._id,TMDB:a.props.TMDB,Title:a.props.Title,poster:null},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e="http://image.tmdb.org/t/p/w185/".concat(this.state.poster);return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null,r.a.createElement(C.a,{className:"movie-card",md:4},r.a.createElement(f.b,{to:"movies/".concat(this.state.id)},r.a.createElement("img",{src:e,alt:this.state.Title})))))}}]),t}(n.Component),U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){return a.updateMoviesList()},a.updateMoviesList=function(){a._movieService.getAllMovies().then((function(e){return a.setState({movies:e.data})})).catch((function(e){return console.log("Error",e)}))},a._movieService=new w,a.state={movies:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement(O.a,null,r.a.createElement("h1",null,"Movies"),r.a.createElement(j.a,null,this.state.movies.map((function(e){return r.a.createElement(L,Object.assign({key:e._id},e))})))))}}]),t}(n.Component),I=function(){return r.a.createElement(O.a,null,r.a.createElement("section",null,r.a.createElement("h1",null,"Moviestorm!"),r.a.createElement("p",null,"Encuentra la peli perfecta")),r.a.createElement(U,null))},T=a(28),k=a(111),M=a(69),y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.username,r=t.password;a._service.signup(n,r).then((function(e){console.log(e),a.setState({username:"",password:""}),a.props.setUser(e),a.props.history.push("/")})).catch((function(e){return console.log(e)}))},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(T.a)({},n,r))},a._service=new v,a.state={username:"",password:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(O.a,null,r.a.createElement("h1",null,"Registro"),r.a.createElement(k.a,{onSubmit:this.handleSubmit},r.a.createElement(k.a.Group,null,r.a.createElement(k.a.Label,null,"Usuario"),r.a.createElement(k.a.Control,{type:"text",name:"username",onChange:this.handleInputChange,value:this.state.username})),r.a.createElement(k.a.Group,null,r.a.createElement(k.a.Label,null,"Contrase\xf1a"),r.a.createElement(k.a.Control,{type:"password",name:"password",onChange:this.handleInputChange,value:this.state.password})),r.a.createElement(M.a,{variant:"dark",type:"submit"},"Registrarme")))}}]),t}(n.Component),x=a(46),A=a(112),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState({user:Object(x.a)({},a.state.user,Object(T.a)({},n,r))})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.user,n=t.username,r=t.password;a._service.login(n,r).then((function(e){a.props.setUser(e.data),a.setState({username:"",password:""}),a.props.history.push("/")})).catch((function(e){a.handleToastOpen(e.response.data.message)}))},a.handleToastClose=function(){return a.setState({showToast:!1,toastText:""})},a.handleToastOpen=function(e){return a.setState({showToast:!0,toastText:e})},a._service=new v,a.state={showToast:!1,toastText:"",user:{username:"",password:""}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(O.a,null,r.a.createElement("h1",null,"Iniciar sesi\xf3n"),r.a.createElement(k.a,{onSubmit:this.handleSubmit},r.a.createElement(k.a.Group,null,r.a.createElement(k.a.Label,null,"Usuario"),r.a.createElement(k.a.Control,{type:"text",name:"username",onChange:this.handleInputChange,value:this.state.username})),r.a.createElement(k.a.Group,null,r.a.createElement(k.a.Label,null,"Contrase\xf1a"),r.a.createElement(k.a.Control,{type:"password",name:"password",onChange:this.handleInputChange,value:this.state.password})),r.a.createElement(M.a,{variant:"dark",type:"submit"},"Iniciar sesi\xf3n")),r.a.createElement(A.a,{onClose:this.handleToastClose,show:this.state.showToast,delay:3e3,autohide:!0,style:{position:"fixed",right:"10px",bottom:"10px",minWidth:"250px"}},r.a.createElement(A.a.Header,null,r.a.createElement("strong",{className:"mr-auto"},"Error"),r.a.createElement("small",null,"Session manager")),r.a.createElement(A.a.Body,null,this.state.toastText)))}}]),t}(n.Component),N=a(109),D=a(49),W=a(110),G=function e(){var t=this;Object(i.a)(this,e),this.createList=function(e){return t._service.post("/newList",{movielist:e})},this.addMovieToList=function(e){return t._service.post("/addMovieToList",{addMovieToList:e})},this.getAllLists=function(){return t._service.get("/getAllLists")},this.getAllListsFromUser=function(e){return t._service.get("/getAllListsFromUser/".concat(e))},this._service=p.a.create({baseURL:"http://localhost:5000/api/lists",withCredentials:!0})},R=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=a.state.list;a._ServiceList.createList(t).then((function(e){a.props.closeModalWindow()})).catch((function(e){return console.log(e)}))},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState({list:Object(x.a)({},a.state.list,Object(T.a)({},n,r))})},a._ServiceList=new G,a.state={list:{listName:"",creator:a.props.idUser,movies:[a.props.idMovie]}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{onSubmit:this.handleSubmit},r.a.createElement(k.a.Group,null,r.a.createElement(k.a.Label,null,"Create a new list:"),r.a.createElement(k.a.Control,{type:"text",name:"listName",id:"listName",onChange:this.handleInputChange,value:this.state.list.listName})),r.a.createElement(M.a,{variant:"dark",size:"sm",type:"submit",disabled:this.state.disabledButton}," Create and Add")))}}]),t}(n.Component),F=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){console.log("el usuarioi es::::: ",a.props.loggedInUser);var e=a.props.match.params.id;a._movieService.getOneMovie(e).then((function(e){a.setState({movie:e.data},(function(){a.apiInfo()}))})).then((function(){return a._listService.getAllListsFromUser(a.props.loggedInUser._id)})).catch((function(e){return console.log(e)}))},a.apiInfo=function(){a._apiService.getMovieByID(a.state.movie.TMDB).then((function(e){a.setState({poster:e.data.poster_path})})).catch((function(e){return console.log(e)}))},a.handleShowCreate=function(){return a.setState({showModalWindowCreate:!0})},a.handleCloseCreate=function(){return a.setState({showModalWindowCreate:!1})},a.handleAddToExistentList=function(e){var t=e.target.dataset.value;console.log(t)},a._movieService=new w,a._apiService=new _,a._listService=new G,a.state={movie:null,poster:null,showModalWindowCreate:!1,showModalWindowAdd:!1,loggedInUser:null,list:{},user:{}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e="http://image.tmdb.org/t/p/w185/".concat(this.state.poster),t=this.props.match.params.id;return this.state.movie?r.a.createElement(O.a,{className:"movie-details"},r.a.createElement("section",null,r.a.createElement(j.a,null,r.a.createElement(C.a,null,r.a.createElement("img",{src:e,alt:"Movie poster"}),this.props.loggedInUser&&r.a.createElement(M.a,{variant:"dark",onClick:this.handleShowCreate},"Create and add to list"),this.props.loggedInUser&&r.a.createElement(N.a,{variant:"dark",id:"dropdown-basic-button",title:"Add to list"},r.a.createElement(D.a.Item,{onClick:this.handleAddToExistentList,"data-value":this.state.user.lists},"Lista 1"))),r.a.createElement(C.a,{md:6},r.a.createElement("h1",null,this.state.movie.Title),r.a.createElement("p",null,r.a.createElement("strong",null,"Genres:")," ",this.state.movie.Genre1),r.a.createElement("p",null,r.a.createElement("strong",null,"SubGenre:")," ",this.state.movie.SubGenre1,", ",this.state.movie.SubGenre2),r.a.createElement("p",null,r.a.createElement("strong",null,"Theme:")," ",this.state.movie.Theme1,", ",this.state.movie.Theme2,", ",this.state.movie.Theme3,", ",this.state.movie.Theme4,", ",this.state.movie.Theme5,", "),r.a.createElement("p",null,r.a.createElement("strong",null,"Mood:")," ",this.state.movie.Mood1),r.a.createElement("p",null,r.a.createElement("strong",null,"Stream:")," ",this.state.movie.Stream1),r.a.createElement(f.b,{to:"/",className:"btn btn-dark"},"Volver"))),r.a.createElement(W.a,{show:this.state.showModalWindowCreate,onHide:this.handleCloseCreate},r.a.createElement(W.a.Header,{closeButton:!0},r.a.createElement(W.a.Title,null,"Create and add to list")),r.a.createElement(W.a.Body,null,r.a.createElement(R,{closeModalWindow:this.handleCloseCreate,idMovie:t}))))):"Waiting for the movie"}}]),t}(n.Component),H=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){return a.updateAllLists()},a.updateAllLists=function(){a._service.getAllLists().then((function(e){return a.setState({lists:e.data})})).catch((function(e){return console.log("Error",e)}))},a._service=new G,a.state={lists:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("h1",null,"Pruebaaaaaaa")}}]),t}(n.Component),J=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).setTheUser=function(t){e.setState({loggedInUser:t})},e.fetchUser=function(){null===e.state.loggedInUser&&e._service.loggedin().then((function(t){return e.setState({loggedInUser:t.data})})).catch((function(t){e.setState({loggedInUser:!1}),console.log("Ha habido un error en fecthUser()",{err:t})}))},e.state={loggedInUser:null},e._service=new v,e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.fetchUser(),r.a.createElement(r.a.Fragment,null,r.a.createElement(b,{loggedInUser:this.state.loggedInUser,setUser:this.setTheUser}),r.a.createElement(h.c,{className:"body"},r.a.createElement(h.a,{exact:!0,path:"/",component:I}),r.a.createElement(h.a,{exact:!0,path:"/movies",render:function(){return r.a.createElement(U,{loggedInUser:e.state.loggedInUser})}}),r.a.createElement(h.a,{path:"/movies/:id",render:function(t){return r.a.createElement(F,Object.assign({loggedInUser:e.state.loggedInUser},t))}}),r.a.createElement(h.a,{path:"/lists",component:H}),r.a.createElement(h.a,{path:"/signup",render:function(t){return r.a.createElement(y,Object.assign({setUser:e.setTheUser},t))}}),r.a.createElement(h.a,{path:"/login",render:function(t){return r.a.createElement(B,Object.assign({setUser:e.setTheUser},t))}})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(103),a(104);o.a.render(r.a.createElement(f.a,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},74:function(e,t,a){e.exports=a(105)},79:function(e,t,a){}},[[74,1,2]]]);
//# sourceMappingURL=main.0f6180de.chunk.js.map